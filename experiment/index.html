<!doctype html><html lang="en" class="no-js"><head><meta charset="utf-8"> <!-- begin SEO --><title>Experiment - About</title><meta property="og:locale" content="en-US"><meta property="og:site_name" content="About"><meta property="og:title" content="Experiment"><link rel="canonical" href="https://gregory-ch.github.io/experiment/"><meta property="og:url" content="https://gregory-ch.github.io/experiment/"> <script type="application/ld+json"> { "@context" : "http://schema.org", "@type" : "Person", "name" : "Chernov Gregory", "url" : "https://gregory-ch.github.io", "sameAs" : null } </script> <!-- end SEO --><link href="https://gregory-ch.github.io/feed.xml" type="application/atom+xml" rel="alternate" title="About Feed"> <!-- http://t.co/dKP3o1e --><meta name="HandheldFriendly" content="True"><meta name="MobileOptimized" content="320"><meta name="viewport" content="width=device-width, initial-scale=1.0"> <script> document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js '; </script> <!-- For all browsers --><link rel="stylesheet" href="https://gregory-ch.github.io/assets/css/main.css"><meta http-equiv="cleartype" content="on"> <!-- start custom head snippets --><link rel="apple-touch-icon" sizes="57x57" href="https://gregory-ch.github.io/images/apple-touch-icon-57x57.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="60x60" href="https://gregory-ch.github.io/images/apple-touch-icon-60x60.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="72x72" href="https://gregory-ch.github.io/images/apple-touch-icon-72x72.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="76x76" href="https://gregory-ch.github.io/images/apple-touch-icon-76x76.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="114x114" href="https://gregory-ch.github.io/images/apple-touch-icon-114x114.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="120x120" href="https://gregory-ch.github.io/images/apple-touch-icon-120x120.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="144x144" href="https://gregory-ch.github.io/images/apple-touch-icon-144x144.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="152x152" href="https://gregory-ch.github.io/images/apple-touch-icon-152x152.png?v=M44lzPylqQ"><link rel="apple-touch-icon" sizes="180x180" href="https://gregory-ch.github.io/images/apple-touch-icon-180x180.png?v=M44lzPylqQ"><link rel="icon" type="image/png" href="https://gregory-ch.github.io/images/favicon-32x32.png?v=M44lzPylqQ" sizes="32x32"><link rel="icon" type="image/png" href="https://gregory-ch.github.io/images/android-chrome-192x192.png?v=M44lzPylqQ" sizes="192x192"><link rel="icon" type="image/png" href="https://gregory-ch.github.io/images/favicon-96x96.png?v=M44lzPylqQ" sizes="96x96"><link rel="icon" type="image/png" href="https://gregory-ch.github.io/images/favicon-16x16.png?v=M44lzPylqQ" sizes="16x16"><link rel="manifest" href="https://gregory-ch.github.io/images/manifest.json?v=M44lzPylqQ"><link rel="mask-icon" href="https://gregory-ch.github.io/images/safari-pinned-tab.svg?v=M44lzPylqQ" color="#000000"><link rel="shortcut icon" href="/images/favicon.ico?v=M44lzPylqQ"><meta name="msapplication-TileColor" content="#000000"><meta name="msapplication-TileImage" content="https://gregory-ch.github.io/images/mstile-144x144.png?v=M44lzPylqQ"><meta name="msapplication-config" content="https://gregory-ch.github.io/images/browserconfig.xml?v=M44lzPylqQ"><meta name="theme-color" content="#ffffff"><link rel="stylesheet" href="https://gregory-ch.github.io/assets/css/academicons.css"/> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ TeX: { equationNumbers: { autoNumber: "all" } } }); </script> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ], processEscapes: true } }); </script> <script src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/latest.js?config=TeX-MML-AM_CHTML' async></script> <!-- end custom head snippets --></head><body> <!--[if lt IE 9]><div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav id="site-nav" class="greedy-nav"><div class="menu-button"> <span></span> <span></span> <span></span></div><ul class="visible-links"><li class="masthead__menu-item masthead__menu-item--lg"><a href="https://gregory-ch.github.io/">About</a></li><li class="masthead__menu-item"><a href="https://gregory-ch.github.io/publications/">Publications</a></li><li class="masthead__menu-item"><a href="https://gregory-ch.github.io/talks/">Talks</a></li><li class="masthead__menu-item"><a href="https://gregory-ch.github.io/blog/">Blog</a></li><li class="masthead__menu-item"><a href="https://gregory-ch.github.io/cv/">CV</a></li></ul><ul class="hidden-links hidden"></ul></nav></div></div></div><script> document.querySelector('.menu-button').addEventListener('click', function() { this.classList.toggle('active'); document.querySelector('.visible-links').classList.toggle('show'); }); </script><div id="main" role="main"><div class="sidebar sticky"><div itemscope itemtype="http://schema.org/Person"><div class="author__avatar"> <img src="https://gregory-ch.github.io/images/profile.png" class="author__avatar" alt="Chernov Gregory"></div><div class="author__content"><h3 class="author__name">Chernov Gregory</h3><p class="author__bio">Behavioral scientist, now researcher in UCL</p></div><div class="author__urls-wrapper"> <button class="btn btn--inverse">Follow</button><ul class="author__urls social-icons"><li><i class="fa fa-fw fa-map-marker" aria-hidden="true"></i> London</li><li><a href="https://twitter.com/de_marcacio"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i> Twitter</a></li><li><a href="https://www.linkedin.com/in/gregory-ch/"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li><li><a href="https://github.com/gregory-ch"><i class="fab fa-fw fa-github" aria-hidden="true"></i> Github</a></li></ul></div></div></div><article class="page" itemscope itemtype="http://schema.org/CreativeWork"><meta itemprop="headline" content="Experiment"><div class="page__inner-wrap"><header><h1 class="page__title" itemprop="headline">Experiment</h1></header><section class="page__content" itemprop="text"><style> body { overflow: auto; } .experiment-container { text-align: center; max-width: 800px; margin: 30px auto; padding: 30px; background-color: #f9f9f9; border-radius: 8px; box-shadow: 0 4px 15px rgba(0,0,0,0.15); } .button { background-color: #3498db; color: white; border: none; padding: 15px 30px; margin: 20px 0; font-size: 18px; font-weight: bold; border-radius: 6px; cursor: pointer; transition: all 0.3s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); display: inline-block; text-decoration: none; } .button:hover { background-color: #2980b9; transform: translateY(-2px); box-shadow: 0 6px 8px rgba(0,0,0,0.15); } .green-button { background-color: #2ecc71; } .green-button:hover { background-color: #27ae60; } #status-message { margin: 20px 0; padding: 10px; font-style: italic; color: #666; } #result-container { margin: 20px 0; padding: 15px; border: 2px dashed #3498db; border-radius: 6px; background-color: #f0f8ff; text-align: left; display: none; } .result-link { word-break: break-all; display: block; margin: 10px 0; color: #3498db; font-weight: bold; } #error-message { margin: 20px 0; padding: 10px; color: #e74c3c; background-color: #fadbd8; border-radius: 4px; font-weight: bold; display: none; } .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid rgba(0,0,0,0.1); border-radius: 50%; border-top-color: #3498db; animation: spin 1s ease-in-out infinite; margin-left: 10px; } @keyframes spin { to { transform: rotate(360deg); } }</style><div class="experiment-container"><h2>oTree Experiment Session Link Generator</h2><p>Click the button below to generate a new session link for the oTree experiment:</p><button id="generate-button" class="button">Generate Session Link</button><div id="status-message"></div><div id="error-message"></div><div id="result-container"><h3>Your Session Link:</h3><a id="result-link" href="#" target="_blank" class="result-link"></a> <button id="open-button" class="button green-button">Open in New Tab</button></div></div><script> // Глобальная переменная для хранения найденной ссылки var sessionUrl = ''; // Функция для установки статуса function setStatus(message, loading) { var statusElement = document.getElementById('status-message'); if (!statusElement) return; if (loading) { statusElement.innerHTML = message + ' <span class="spinner"></span>'; } else { statusElement.textContent = message; } } // Функция для отображения ошибки function showError(message) { var errorElement = document.getElementById('error-message'); if (!errorElement) return; errorElement.textContent = message; errorElement.style.display = 'block'; setStatus('Failed to generate link', false); } // Функция для отображения результата function showResult(link) { var resultContainer = document.getElementById('result-container'); var resultLink = document.getElementById('result-link'); if (!resultContainer || !resultLink) return; sessionUrl = link; resultLink.href = link; resultLink.textContent = link; resultContainer.style.display = 'block'; setStatus('Session link successfully generated!', false); } // Функция для открытия ссылки в новом окне function openInNewTab() { if (sessionUrl) { window.open(sessionUrl, '_blank'); } } // Функция для поиска ссылки в HTML function findLinkInHtml(html) { console.log("Got HTML response, length: " + html.length); console.log("HTML preview: " + html.substring(0, 200)); // Попробуем найти ссылку по разным шаблонам var patterns = [ /href=["']([^"']*\/room\/[^"']*)["'][^>]*>Session-wide demo link/i, /https:\/\/belabeu-e7061ee8ef78\.herokuapp\.com\/join\/([a-z0-9]+)/i, /https:\/\/belabeu-e7061ee8ef78\.herokuapp\.com\/room\/([a-z0-9]+)/i, /SessionStartLinks\/([a-z0-9]+)/i ]; // Проверяем каждый шаблон for (var i = 0; i < patterns.length; i++) { var match = html.match(patterns[i]); if (match) { if (i === 0 && match[1]) { // Session-wide demo link console.log("Found session link (pattern " + i + "): " + match[1]); return match[1]; } else if (i === 3 && match[1]) { // SessionStartLinks var fullLink = "https://belabeu-e7061ee8ef78.herokuapp.com/SessionStartLinks/" + match[1]; console.log("Found session link (pattern " + i + "): " + fullLink); return fullLink; } else if (match[0]) { // join or room links console.log("Found session link (pattern " + i + "): " + match[0]); return match[0]; } } } // Если ничего не нашли, ищем любые URL var urlPattern = /https:\/\/belabeu-e7061ee8ef78\.herokuapp\.com\/[a-z0-9\/\-_?=&]+/gi; var allUrls = html.match(urlPattern); if (allUrls && allUrls.length > 0) { console.log("Found URLs: ", allUrls); // Ищем наиболее подходящую ссылку for (var j = 0; j < allUrls.length; j++) { var url = allUrls[j]; if (url.includes('/room/') || url.includes('/join/') || url.includes('SessionStartLinks')) { console.log("Selected most relevant URL: " + url); return url; } } // Если не нашли подходящую, берем первую console.log("Taking first URL found: " + allUrls[0]); return allUrls[0]; } console.log("No links found in HTML"); return null; } // Основная функция для генерации ссылки function generateExperimentLink() { console.log("Generate button clicked"); // Сбрасываем UI var errorElement = document.getElementById('error-message'); if (errorElement) errorElement.style.display = 'none'; var resultContainer = document.getElementById('result-container'); if (resultContainer) resultContainer.style.display = 'none'; // Показываем состояние загрузки setStatus('Connecting to oTree server...', true); // Создаем AJAX-запрос var xhr = new XMLHttpRequest(); xhr.open('GET', 'https://belabeu-e7061ee8ef78.herokuapp.com/demo/dsst?test=1', true); // Обработчик ответа xhr.onload = function() { if (xhr.status >= 200 && xhr.status < 300) { console.log("Received response, status: " + xhr.status); // Ищем ссылку в HTML var link = findLinkInHtml(xhr.responseText); if (link) { showResult(link); } else { showError("Could not find session link in the response."); } } else { showError("Server returned error: " + xhr.status); } }; // Обработчик ошибки xhr.onerror = function() { console.error("Network error occurred"); showError("Network error occurred. CORS may be blocking the request."); }; // Отправляем запрос try { xhr.send(); console.log("Request sent to oTree server"); } catch (error) { console.error("Error sending request:", error); showError("Error sending request: " + error.message); } } // Добавление обработчиков событий при загрузке страницы window.onload = function() { console.log("Page loaded, attaching event handlers"); var generateButton = document.getElementById('generate-button'); if (generateButton) { generateButton.addEventListener('click', generateExperimentLink); console.log("Added click handler to generate button"); } else { console.error("Generate button not found!"); } var openButton = document.getElementById('open-button'); if (openButton) { openButton.addEventListener('click', openInNewTab); console.log("Added click handler to open button"); } else { console.error("Open button not found!"); } console.log("oTree experiment script loaded at " + new Date().toISOString()); }; </script></section><footer class="page__meta"></footer></div></article></div><!--<div class="page__footer-follow"><ul class="social-icons"><li><strong>Follow:</strong></li><li><a href="http://github.com/gregory-ch"><i class="fab fa-github" aria-hidden="true"></i> GitHub</a></li><li><a href="https://gregory-ch.github.io/feed.xml"><i class="fa fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li></ul></div><div class="page__footer-copyright">&copy; 2025 Chernov Gregory. Powered by <a href="http://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://github.com/academicpages/academicpages.github.io">AcademicPages</a>, a fork of <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>--> <script src="https://gregory-ch.github.io/assets/js/main.min.js"></script> <script> (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){ (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o), m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m) })(window,document,'script','//www.google-analytics.com/analytics.js','ga'); ga('create', '', 'auto'); ga('send', 'pageview'); </script></body></html>
